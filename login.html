<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tails Up | Login</title>
    <link rel="stylesheet" href="css/mystilelogin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="css/mensajesAlerta.css">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="images/isotipoTailsUp.png" type="image/x-icon">
</head>

<body>
    <div class="container">
        <div class="login-box">
            <div class="logo">
                <img src="images/logo.png" alt="Tails Up">
            </div>
            <button class="google-btn">
                <img src="images/google-icon.png" alt="Google"> Iniciar con Google
            </button>
            <div class="divider">Inicia con un correo</div>
            <form id="loginForm">
                <div class="input-group">
                    <img src="images/email-icon.png" alt="Email">
                    <input type="email" placeholder="Email" required name="email">
                </div>
                <div class="input-group">
                    <img src="images/lock-icon.png" alt="Contraseña">
                    <input type="password" placeholder="Contraseña" required name="contrasena">
                </div>
                <a href="/recuperar.html" class="forgot-password">¿Olvidaste tu contraseña?</a>
                <button type="submit" class="login-btn" name="btnInicioSesion" href="index.html">Iniciar sesión</button>
            </form>
            <p class="register">¿Aún no tienes una cuenta? <a href="registro.html">Regístrate</a></p>
        </div>
        <div class="info-box">
            <div class="paw-icons">
                <img src="images/patita.png" class="huella1">
                <img src="images/patita.png" class="huella2">
            </div>
            <img src="images/mascota.png" alt="Mujer con perro" class="info-img">

            <h2>Un sitio para tu mascota</h2>
            <p>Esto es un placeholder del texto que pondremos en esta sección
                Esto es un placeholder del texto que pondremos en esta sección
                Esto es un placeholder del texto que pondremos en esta sección
            </p>
        </div>
        <div id="customAlertContainer" class="custom-alert-container"></div>
    </div>
    <script>
document.getElementById('loginForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);

    try {
        const response = await fetch('http://localhost/TailsUp-Backend/endPointLogin.php', {
            method: 'POST',
            body: formData
        });

        const data = await response.json();

        if (data.success) {
            // Guarda el nombre del usuario en localStorage
            localStorage.setItem('usuario', data.nombre); // Ajusta 'nombre' al campo real que devuelve tu endpoint
            localStorage.setItem('idUsuario', data.idUsuario); // Ajusta 'idUsuario' al campo real que devuelve tu endpoint
            // Redirige al index
            window.location.href = 'index.html';
        } else {
            showCustomAlert('Credenciales incorrectas', '#E52727');
        }
    } catch (error) {
        console.error('Error:', error);
        showCustomAlert('Error al iniciar sesión', '#E52727');
    }
});
</script>   

</body>
<script src="js/customAlerts.js"></script>
</html>